<template>
    <div class="main" style={backgroundStyle}>
        <!-- Title -->
        <lightning-layout class="" multiple-rows style="background-color: #0d5baa;">
            <!-- IP details -->
            <lightning-layout-item class="userip" padding="around-medium">
                <lightning-layout style="font-size: 1rem;">
                    <b>Your Details:</b>
                </lightning-layout>
                <lightning-layout>
                    <b>IP:</b> {ipinfo.ip}
                </lightning-layout>
                <lightning-layout>
                    {ipinfo.city}, {ipinfo.region}, {ipinfo.country}
                </lightning-layout>
                <lightning-layout>
                    <b>TZ:</b> {ipinfo.timezone}
                </lightning-layout>
                <lightning-layout>
                    <b>Loc:</b> {ipinfo.loc}
                </lightning-layout>
            </lightning-layout-item>
            <!-- title -->
            <lightning-layout-item class="title" padding="around-medium">
                WORLD CLOCK
            </lightning-layout-item>
            <!-- time format toggle -->
            <lightning-layout-item alignment-bump="left" padding="around-medium">
                <lightning-input data-id="toggle" 
                                    class="textInput"
                                    type="toggle" 
                                    label="time Format" 
                                    checked={checked} 
                                    onchange={handleChangeFormat}
                                    message-toggle-active="12 hr" 
                                    message-toggle-inactive="24 hr"
                                    variant="label-hidden"></lightning-input>
            </lightning-layout-item>
        </lightning-layout>

        <!-- Time Card -->
        <lightning-layout class="slds-align_absolute-center slds-p-around_medium" multiple-rows style="background-color: midnightblue;">
            <lightning-layout-item class="userip">
                <div class="slds-box">
                    <table>
                        <tr>
                            <td colspan="2">
                                <lightning-layout class="slds-align_absolute-center" style="font-size: 1rem;">
                                    Weather Forecast
                                </lightning-layout>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <lightning-layout class="slds-align_absolute-center slds-border_bottom">
                                    <lightning-icon class="loc-icon" icon-name="utility:checkin" alternative-text="Loc" title="Loc" size="x-small">
                                    </lightning-icon>
                                    {weather.name}, {weather.country}
                                </lightning-layout>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <lightning-layout class="slds-align_absolute-center" padding="small" style="font-size: 1rem;">
                                    {weather.title}, {weather.description}
                                </lightning-layout>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-bottom: 1rem;">
                                <table>
                                    <tr>
                                        <td>
                                            <img id="wicon" src={weather.img} style="width: 5rem;" class="slds-align_absolute-center">
                                        </td>
                                        <td style="font-size: 20px;">
                                            {weather.temp}<span class="degree">°C</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th rowspan="2" style="padding-right: 1rem;">
                                            {weather.temp_max}<span style="font-size: 8px;" class="degree">°C</span> / {weather.temp_min}<span style="font-size: 8px;" class="degree">°C</span>
                                        </th>
                                        <td>Feels Like</td>
                                    </tr>
                                    <tr>
                                        <td>{weather.feels_like}</td>
                                    </tr>
                                </table>
                            </td>
                            <td>
                                <table>
                                    <tr>
                                        <td>Pressure:</td>
                                        <td>{weather.pressure}hPa</td>
                                    </tr>
                                    <tr>
                                        <td>Humidity:</td>
                                        <td>{weather.humidity}%</td>
                                    </tr>
                                    <tr>
                                        <td>Visibility:</td>
                                        <td>{weather.visibility}m</td>
                                    </tr>
                    
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-right: 1rem;">
                                <table>
                                    <tr>
                                        <td colspan="2">
                                            <lightning-layout-item class="slds-align_absolute-center" style="letter-spacing: 8px; text-transform: uppercase;">
                                                twilight
                                            </lightning-layout-item>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <table>
                                                <tr>
                                                    <th rowspan="2" style="font-size: 1rem;">
                                                        <img id="sunrise" src={sunrise} style="width: 40px;">
                                                    </th>
                                                    <td>Sunrise</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <lightning-formatted-date-time value={weather.sunrise} hour="numeric" minute="numeric"
                                                                                        second="numeric">
                                                        </lightning-formatted-date-time>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td>
                                            <table>
                                                <tr>
                                                    <th rowspan="2" style="font-size: 1rem;">
                                                        <img id="sunset" src={sunset} style="width: 40px;">
                                                    </th>
                                                    <td>Sunset</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <lightning-formatted-date-time value={weather.sunset} hour="numeric" minute="numeric"
                                                                                        second="numeric">
                                                        </lightning-formatted-date-time>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td style="padding-left: 1rem;">
                                <table>
                                    <tr>
                                        <td colspan="2">
                                            <lightning-layout-item style="letter-spacing: 8px; text-transform: uppercase;">wind
                                            </lightning-layout-item>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Speed</td>
                                        <td>Gust</td>
                                    </tr>
                                    <tr>
                                        <td>{weather.speed}m/s</td>
                                        <td>{weather.gust}m/s</td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
            </lightning-layout-item>
            <lightning-layout-item style="width: 23rem;" size="12" small-device-size="12" medium-device-size="4" large-device-size="4" padding="around-small">
                <div class="slds-box">
                    <!-- time -->
                    <lightning-layout class="slds-text-align_center" style="margin-top: -9%;">
                        <lightning-layout-item class="block" padding="around-small">
                            <span class="val" data-id="hour"></span>
                            <span class="text">Hour</span>
                        </lightning-layout-item>
                        <span class="colon slds-align_absolute-center" data-id="">:</span>
                        <lightning-layout-item class="block" padding="around-small">
                            <span class="val" data-id="min"></span>
                            <span class="text">Minute</span>
                        </lightning-layout-item>
                        <span class="colon slds-align_absolute-center" data-id="">:</span>
                        <lightning-layout-item class="block" padding="around-small">
                            <span class="val" data-id="sec"></span>
                            <span class="text">Seconds</span>
                        </lightning-layout-item>
                        <span class="meridiem" data-id="meridiem"></span>
                    </lightning-layout>
                    <!-- date / timezone -->
                    <lightning-layout class="slds-align_absolute-center">
                        <lightning-layout-item class="" style="width: 4rem;" padding="around-small">
                            <img class="flag" data-id="flag" src={ipinfo.countryflag} alt="Flag">
                        </lightning-layout-item>
                        <lightning-layout-item class="" style="letter-spacing: 1px;">
                            <lightning-formatted-date-time value={ipinfo.datetime} 
                                                    year="numeric" 
                                                    month="short" 
                                                    day="numeric" 
                                                    weekday="long"
                                                    hour12="true"
                                                    time-zone-name="long"
                                                    time-zone={timezone}></lightning-formatted-date-time>
                        </lightning-layout-item>
                    </lightning-layout>
                </div>
            </lightning-layout-item>
        </lightning-layout>

        <!-- favourites -->
        <lightning-layout multiple-rows class="slds-p-around_small" style="background-color: steelblue;">
            <lightning-layout-item class="slds-align_absolute-center fav" padding="around-small">
                favourites
            </lightning-layout-item>
            <lightning-layout-item alignment-bump="left" padding="around-small">
                <lightning-icon icon-name="action:close" 
                                alternative-text="Add" 
                                title="Add" 
                                size="small" 
                                class="addicon" 
                                onclick={handleModalPopUp}></lightning-icon>
            </lightning-layout-item>
        </lightning-layout>

        <!-- List of fav World clocks -->
        <c-fav-time-card onremoved={updateFavTimeList}></c-fav-time-card>
    </div>
</template>